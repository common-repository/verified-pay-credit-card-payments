{"version":3,"sources":["webpack://@vpay/VerifiedPay/./src/AbstractModule.ts","webpack://@vpay/VerifiedPay/./src/Gateway.ts","webpack://@vpay/VerifiedPay/./src/Payment.ts","webpack://@vpay/VerifiedPay/./src/VerifiedPay.ts","webpack://@vpay/VerifiedPay/./src/WebHelpers.ts","webpack://@vpay/VerifiedPay/./src/admin/AdminControls.ts","webpack://@vpay/VerifiedPay/./src/admin/Tooltips.ts","webpack://@vpay/VerifiedPay/./src/structs/PaymentButtonID.ts","webpack://@vpay/VerifiedPay/./src/structs/PaymentMap.ts","webpack://@vpay/VerifiedPay/./src/structs/PaymentResponse.ts","webpack://@vpay/VerifiedPay/webpack/bootstrap","webpack://@vpay/VerifiedPay/./index.ts"],"names":["plugin","webHelpers","this","getWebHelpers","config","lastVerifiedTxId","postID","rand","getRandomString","unixTimestamp","Math","floor","Date","now","amount","currency","type","description","verifiedTxId","generateRandomTxId","toUpperCase","desc","encodeURI","length","siteUrl","trim","frameUrl","replace","toFixed","len","hex","chars","random","i","charAt","Payment","AbstractModule","super","payments","PaymentMap","paymentType","currentPayID","gateway","Gateway","getConfig","addPayFrameListeners","$","window","document","ready","undefined","woocommerce","paymentPage","onMessage","event","origin","gatewayOrigin","log","data","func","call","err","console","error","addEventListener","attachEvent","Promise","resolve","reject","status","reloadAfterPay","location","reload","height","attr","button","fadeOut","fadeIn","$btn","buttonIdStr","paymentButtonID","PaymentButtonID","parseFloat","frame","createElement","tr","order","post","src","getPayFrameUrl","scrolling","style","overflow","width","frameHolder","append","getLastGeneratedTxId","paymentEmpty","PaymentResponse","is_restricted","set","input","$input","val","$buttonWrap","find","text","timeoutSec","selector","orderID","setTimeout","remove","VerifiedPay","consentCookieName","CONSENT_COOKIE_NAME","confirmCookiesMsg","CONFIRM_COOKIES_MSG","confirmCookiesBtn","CONFIRM_COOKIES_BTN","WebHelpers","tooltips","Tooltips","adminControls","AdminControls","payment","init","checkCookieConsent","cssSelectors","navigator","language","substr","toLowerCase","c_name","x","y","ARRcookies","cookie","split","indexOf","decodeURI","name","value","expireDays","date","getTime","cookieLifeDays","toUTCString","cookiePath","click","confirmCookies","getCookie","atob","btoa","variables","safeHtml","toString","e","start","end","placeHolder","substring","translation","key","textPiece","escapeOutput","reg","RegExp","match","convertNewlines","str","args","arguments","test","userAgent","MSStream","cached","originRegex","escapeRegex","styleSheets","sheet","href","rules","u","selectorText","push","imports","selectors","getAllCssSelectors","setCookie","path","callback","dataType","url","fixRelativeUrl","get","textStatus","jqXHR","fullUrl","getTooltips","initToolTips","jQuery","that","tsfL10n","touchBuffer","inTouchBuffer","setEvents","target","unset","touchEvents","$target","off","body","on","mouseMove","mouseLeave","touchRemove","updateDesc","classList","contains","tooltipText","querySelector","Element","innerHTML","dataset","$tooltip","$arrow","overflowDir","parseInt","isNaN","round","css","pagex","originalEvent","pageX","arrowBoundary","arrowWidth","$hoverItemWrap","closest","mousex","offset","left","$textWrap","textWrapWidth","outerWidth","adjust","adjustDir","boundaryRight","clearTimeout","$keepBalloon","balloonSelector","hasClass","$children","children","not","loadToolTip","isTouch","$hoverItem","title","$boundary","tooltipHeight","outerHeight","tooltipTop","top","prop","addClass","$innerText","hoverItemWrapWidth","textWidth","textLeft","textRight","boundaryLeft","direction","horIndent","basis","indent","right","mouseEnter","item","_event","Event","trigger","stopPropagation","initTooltips","$wrap","addTooltipBoundary","combinedId","buttonNr","idParts","Error","Map","newData","json","Object","assign","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","verifiedPayPlugin"],"mappings":"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","file":"bundle.js","sourcesContent":["import {VerifiedPay} from \"./VerifiedPay\";\nimport {WebHelpers} from \"./WebHelpers\";\n\n\nexport class AbstractModule {\n    protected plugin: VerifiedPay;\n    protected webHelpers: WebHelpers;\n\n    constructor(plugin: VerifiedPay, webHelpers: WebHelpers = null) {\n        this.plugin = plugin;\n        this.webHelpers = webHelpers ? webHelpers : this.plugin.getWebHelpers();\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n}\n","import {VerifiedPayConfig} from \"./VerifiedPay\";\n\nexport class Gateway {\n    protected lastVerifiedTxId: string = \"\";\n\n    protected config: VerifiedPayConfig;\n\n    constructor(config: VerifiedPayConfig) {\n        this.config = config;\n    }\n\n    public generateRandomTxId(postID: number): string {\n        const rand = this.getRandomString(4, false);\n        const unixTimestamp = Math.floor(Date.now() / 1000);\n        this.lastVerifiedTxId = `${postID}-${unixTimestamp}-${rand}`;\n        return this.lastVerifiedTxId;\n    }\n\n    public getLastGeneratedTxId(): string {\n        return this.lastVerifiedTxId;\n    }\n\n    public getPayFrameUrl(postID: number, amount: number, currency: string, type: string = \"Post\", description: string = \"\"): string {\n        const verifiedTxId = this.generateRandomTxId(postID);\n        currency = currency.toUpperCase(); // TODO undefined on tip button once. how?\n        const desc = encodeURI(description.length !== 0 ? description : `Post ${postID} @ ${this.config.siteUrl}`.trim());\n        const urlStr = this.config.frameUrl\n            .replace(\"{verifiedTxId}\", verifiedTxId)\n            .replace(\"{amount}\", amount.toFixed(8))\n            .replace(\"{currency}\", currency)\n            .replace(\"{desc}\", desc);\n        return urlStr;\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    protected getRandomString(len: number, hex = false) {\n        let chars = hex ? '1234567890ABCDEF' : '1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'\n        let random = ''\n        for (let i = 0; i < len; i++)\n            random += chars.charAt(Math.floor(Math.random() * chars.length))\n        return random\n    }\n}\n","import {AbstractModule} from \"./AbstractModule\";\nimport {VerifiedPay} from \"./VerifiedPay\";\nimport {PaymentResponse} from \"./structs/PaymentResponse\";\nimport {Gateway} from \"./Gateway\";\nimport {PaymentMap} from \"./structs/PaymentMap\";\nimport {PaymentType, RestPaymentParams} from \"./structs/RestPaymentParams\";\nimport {PaymentButtonID} from \"./structs/PaymentButtonID\";\n\ninterface FrameSizeMsg {\n    height: number;\n}\n\nexport class Payment extends AbstractModule {\n    protected gateway: Gateway;\n    protected payments = new PaymentMap(); // pending payments to keep track\n    protected paymentType: PaymentType = \"WP\";\n    protected currentPayID: string = \"\"; // postID-counter\n\n    constructor(plugin: VerifiedPay) {\n        super(plugin);\n        this.gateway = new Gateway(this.plugin.getConfig());\n        const config = this.plugin.getConfig();\n\n        this.addPayFrameListeners();\n        this.plugin.$(this.plugin.window.document).ready(($) => {\n            if (config.woocommerce !== undefined && config.woocommerce.paymentPage === true) {\n                //this.isWoocommercePayment = this.plugin.$(\"body\").hasClass(\"woocommerce-order-received\") === true;\n                this.paymentType = \"WC\";\n            }\n            else if (this.plugin.$(\"h3.rcp_header\").length !== 0)\n                this.paymentType = \"RCP\";\n        });\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    protected addPayFrameListeners() {\n        const config = this.plugin.getConfig();\n        const onMessage = (event) => {\n            if (event.origin !== config.gatewayOrigin) { // TODO use event.target === \"vpay-plugin\" ?\n            //if (event.origin.indexOf(config.gatewayOrigin) === -1) {\n                this.webHelpers.log([\"Skipped message from different origin:\", event.origin, config.gatewayOrigin]);\n                return;\n            }\n\n            // TODO currently our security relies on origin property from browser event.\n            //  we should add another check such as SHA2 signature for larger amounts\n            let data = event.data;\n            //if (typeof(window[data.func]) == \"function\") {\n                //window[data.func].call(null, data.message);\n            if (typeof data.func === \"string\" && typeof(this[data.func]) === \"function\") {\n                try {\n                    this[data.func].call(this, data.data);\n                }\n                catch (err) {\n                    console.error(\"Error calling trusted event callback function: \", err);\n                }\n            }\n        }\n\n        if (window.addEventListener) {\n            window.addEventListener(\"message\", onMessage, false);\n        }\n        // @ts-ignore\n        else if (window.attachEvent) {\n            // @ts-ignore\n            window.attachEvent(\"onmessage\", onMessage, false);\n        }\n    }\n\n    protected onVpayPaid(data: PaymentResponse): Promise<void> {\n        return new Promise<void>((resolve, reject) => {\n            if (!data || data.status !== \"PAID\") {\n                this.webHelpers.log([\"received payment with invalid state\", data.status]);\n                return;\n            }\n\n            const config = this.plugin.getConfig();\n            if (config.reloadAfterPay === true) {\n                this.plugin.window.location.reload();\n                return;\n            }\n            /*\n            this.scheduleRemovePayFrame();\n\n            const verifiedTxId = data.tx_id;\n            let payment = this.payments.mergeWithExisting(verifiedTxId, data);\n            const buttonWrapper = this.plugin.$(\".ct-btn-wrap-\" + this.currentPayID);\n            const button = buttonWrapper.find(\".ct-button-tip\");\n\n            const url = \"wp-json/verifiedpay/v1/register-payment\";\n            let params = this.paymentType === \"WP\" ? RestPaymentParams.fromButton(config, button, data) : RestPaymentParams.fromWoocommerceOrder(config, data);\n            this.webHelpers.getApi(url, params, (data) => {\n                if (data.data === undefined || data.error === true) {\n                    reject({text: \"invalid payment response\", res: data});\n                    return;\n                }\n\n                resolve();\n\n                if (this.paymentType === \"WC\") {\n                    // nothing to do currently. we show the frame a few seconds longer with confirmation icon\n                }\n                else if (this.paymentType === \"RCP\") {\n                    // nothing yet. done via full page payment and their webhook\n                }\n            });\n             */\n        })\n    }\n\n    protected onVpayReturnToMerchant(data: any) {\n        this.plugin.window.location.reload(); // we come from vpay after card can not be charged\n    }\n\n    protected onVpayFrameSize(data: FrameSizeMsg) {\n        this.plugin.$(\".ct-frame-pay iframe\").height(data.height).attr(\"height\", data.height);\n    }\n\n    protected showPaymentFrame(button: Element) {\n        // there can only be 1 payment active\n        // hide all other payment frames (and show there buttons)\n        this.plugin.$(\".ct-button-frame\").fadeOut(\"slow\");\n        this.plugin.$(\".ct-button-wrap\").fadeIn(\"slow\");\n\n        const config = this.plugin.getConfig();\n        const $btn = this.plugin.$(button);\n        //const postID = parseInt($btn.attr(\"data-id\"));\n        const buttonIdStr = $btn.attr(\"data-id\");\n        this.currentPayID = buttonIdStr;\n        const paymentButtonID = new PaymentButtonID(buttonIdStr);\n        const amount = parseFloat($btn.attr(\"data-amount\"));\n        const currency = $btn.attr(\"data-currency\");\n        this.plugin.$(\".ct-btn-wrap-\" + buttonIdStr).fadeOut(\"slow\");\n\n        // create an iframe and append it\n        const frame = document.createElement(\"iframe\");\n        const type = this.paymentType === \"WC\" ? config.tr.order : config.tr.post; // WC frame is currently added on server, not here\n        frame.src = this.gateway.getPayFrameUrl(paymentButtonID.postID, amount, currency, type, \"WooCommerce Order\");\n        frame.scrolling = \"no\";\n        frame.style.overflow = \"hidden\";\n        frame.width = \"400px\";\n        frame.height = \"800px\";\n        const frameHolder = this.plugin.$(\".ct-button-frame-\" + buttonIdStr);\n        frameHolder.append(frame);\n        frameHolder.fadeIn(\"slow\");\n\n        const verifiedTxId = this.gateway.getLastGeneratedTxId();\n        let paymentEmpty = new PaymentResponse();\n        if ($btn.attr(\"data-restricted\") === \"1\")\n            paymentEmpty.is_restricted = true;\n        this.payments.set(verifiedTxId, paymentEmpty);\n    }\n\n    protected updateEditableButtonAmount(input: Element) {\n        const config = this.plugin.getConfig();\n        const $input = this.plugin.$(input);\n        const amount = parseFloat($input.val());\n        const $buttonWrap = this.plugin.$(\".ct-btn-wrap-\" + this.currentPayID);\n        $buttonWrap.find(\".ct-button-tip\").attr(\"data-amount\", amount);\n        $buttonWrap.find(\".ct-btn-display-amount\").text(amount);\n    }\n\n    protected scheduleRemovePayFrame() {\n        const config = this.plugin.getConfig();\n        const timeoutSec = this.paymentType === \"WC\" ? 5 : 0;\n        const frameID = this.paymentType === \"WP\" ? 0 : config.woocommerce.orderID; // TODO RCP\n        const selector = \".ct-button-frame-\" + frameID + \", .ct-button-frame-\" + this.currentPayID;\n        setTimeout(() => {\n            // TODO what if we want multiple buttons per post? storing a new DB entry per shortcode is overkill (as Cashtippr)\n            this.plugin.$(selector).fadeOut(\"slow\");\n            setTimeout(() => {\n                this.plugin.$(selector).remove();\n            }, 1000);\n        }, timeoutSec * 1000);\n    }\n}\n","import {Tooltips} from \"./admin/Tooltips\";\nimport {WebHelpers, WebHelpersConfig} from \"./WebHelpers\";\nimport {Payment} from \"./Payment\";\nimport {AdminControls} from \"./admin/AdminControls\";\nimport {BrowserWindow} from \"./types\";\n\nexport interface VerifiedPayConfig extends WebHelpersConfig {\n    cookieLifeDays: number;\n    cookiePath: string;\n    siteUrl: string;\n    gatewayOrigin: string;\n    frameUrl: string;\n    reloadAfterPay: boolean;\n\n    woocommerce?: {\n        amount: number;\n        currency: string;\n        orderID: number;\n        paymentPage: boolean;\n    }\n\n    // localizations\n    tr: {\n        order: string;\n        post: string;\n    }\n}\n\nexport interface VerifiedPayApiRes {\n    error: boolean;\n    errorMsg: string;\n    data: any[];\n}\n\nexport class VerifiedPay {\n    protected static readonly CONSENT_COOKIE_NAME = \"vp-ck\";\n    protected static readonly CONFIRM_COOKIES_MSG = \"#ct-cookieMsg\";\n    protected static readonly CONFIRM_COOKIES_BTN = \"#ct-confirmCookies\";\n    // TODO separate entryPoints + classes for admin + public code? but tooltips and other admin stuff can be used publicly too (and is quite small)\n\n    public readonly window: BrowserWindow;\n    public readonly $: JQueryStatic;\n\n    protected config: VerifiedPayConfig;\n    protected webHelpers: WebHelpers;\n    protected adminControls: AdminControls;\n    protected tooltips: Tooltips;\n    protected payment: Payment;\n\n    constructor(window: BrowserWindow, $: JQueryStatic) {\n        this.window = window;\n        this.$ = $;\n        this.config = this.window['verifiedPayCfg'] || {};\n        this.config.consentCookieName = VerifiedPay.CONSENT_COOKIE_NAME;\n        this.config.confirmCookiesMsg = VerifiedPay.CONFIRM_COOKIES_MSG;\n        this.config.confirmCookiesBtn = VerifiedPay.CONFIRM_COOKIES_BTN;\n\n        this.webHelpers = new WebHelpers(this.window, this.$, this.config);\n        this.tooltips = new Tooltips(this, this.webHelpers);\n        this.adminControls = new AdminControls(this);\n        this.payment = new Payment(this);\n        this.$(this.window.document).ready(($) => {\n            this.adminControls.init();\n            this.webHelpers.checkCookieConsent();\n        });\n    }\n\n    public getConfig() {\n        return this.config;\n    }\n\n    public getTooltips() {\n        return this.tooltips;\n    }\n\n    public getWebHelpers() {\n        return this.webHelpers;\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n}\n","import {BrowserWindow} from \"./types\";\n\nexport interface WebHelpersConfig {\n    cookieLifeDays: number;\n    cookiePath: string;\n    siteUrl: string;\n\n    // DOM ids of elements of cookie consent message\n    consentCookieName: string;\n    confirmCookiesMsg: string;\n    confirmCookiesBtn: string;\n}\n\nexport class WebHelpers {\n    public readonly window: BrowserWindow;\n    public readonly $: JQueryStatic;\n\n    protected config: WebHelpersConfig;\n    protected cssSelectors: string[] = [];\n\n    constructor(window: BrowserWindow, $: JQueryStatic, config: WebHelpersConfig) {\n        this.window = window;\n        this.$ = $;\n        this.config = config;\n    }\n\n    public getBrowserLang() {\n        return this.window.navigator.language.substr(0, 2).toLowerCase();\n    }\n\n    public getCookie(c_name: string) {\n        let i, x, y;\n        let ARRcookies = this.window.document.cookie.split(\";\");\n        for (i = 0; i < ARRcookies.length; i++)\n        {\n            x = ARRcookies[i].substr(0, ARRcookies[i].indexOf(\"=\"));\n            y = ARRcookies[i].substr(ARRcookies[i].indexOf(\"=\") + 1);\n            x = x.replace(/^\\s+|\\s+$/g,\"\");\n            if (x == c_name)\n                return decodeURI(y);\n        }\n        return null;\n    }\n\n    public setCookie(name: string, value: any, expireDays: number) {\n        let date = new Date();\n        date = new Date(date.getTime()+1000*60*60*24* (expireDays ? expireDays : this.config.cookieLifeDays));\n        //document.cookie = name + \"=\" + value + \"; expires=\" + date.toGMTString() + \"; path=\" + pageData.cookiePath + \"; domain=.\" + location.host;\n        this.window.document.cookie = name + \"=\" + value + \"; expires=\" + date.toUTCString() + \"; path=\" + this.config.cookiePath;\n    }\n\n    public removeCookie(name: string) {\n        //document.cookie = name + \"=; expires=Thu, 02 Jan 1970 00:00:00 UTC; path=\" + pageData.cookiePath + \"; domain=.\" + location.host;\n        this.window.document.cookie = name + \"=; expires=Thu, 02 Jan 1970 00:00:00 UTC; path=\" + this.config.cookiePath;\n    }\n\n    public checkCookieConsent() {\n        this.$(this.config.confirmCookiesBtn).click(() => {\n            this.confirmCookies();\n        });\n        if (this.getCookie(this.config.consentCookieName) !== null)\n            this.$(this.config.confirmCookiesMsg).remove(); // we recently showed the cookie confirm message. some pages might still be in browser cache\n    }\n\n    public fromBase64(data: string) {\n        if (typeof this.window.atob !== \"function\") {\n            this.window.console.error(\"Base64 decoding is not supported in your browser\");\n            return \"\";\n        }\n        return this.window.atob(data);\n    }\n\n    public toBase64(data: string) {\n        if (typeof this.window.btoa !== \"function\") {\n            this.window.console.error(\"Base64 encoding is not supported in your browser\");\n            return \"\";\n        }\n        return this.window.btoa(data);\n    }\n\n    /**\n     * Populate a html template\n     * @param text {String}: The html template (or just normal text with variables)\n     * @param variables {Object}: the key-value pairs with variables names and their content to be set in text\n     * @param safeHtml {boolean, default false}: don't escape html characters if set to true\n     * @returns {String} the translated html\n     */\n    public translate(text: string, variables: any, safeHtml: boolean = false) {\n        if (typeof text !== \"string\") {\n            try {\n                // @ts-ignore\n                text = text.toString();\n            }\n            catch (e) {\n                this.log(\"Text to translate is not a string\");\n                return text;\n            }\n        }\n        let start = 0, end = 0;\n        while ((start = text.indexOf(\"{\", start)) !== -1)\n        {\n            if (start > 0 && text.charAt(start-1) === \"\\\\\") { // escaped javascript code beginning\n                start++;\n                continue;\n            }\n            end = text.indexOf(\"}\", start);\n            if (end === -1) {\n                this.log(\"Can not find end position while translating HTML\");\n                break;\n            }\n            let placeHolder = text.substring(start+1, end);\n            let translation = null;\n            if (placeHolder.substring(0, 3) === \"tr:\") {\n                let key = placeHolder.substring(3);\n                //translation = this.tr(key.toUpperCase());\n                translation = this.tr(key);\n            }\n            else if (typeof variables === \"object\") {\n                let textPiece = variables[placeHolder];\n                if (typeof textPiece !== \"undefined\") {\n                    if (typeof safeHtml === \"boolean\" && safeHtml)\n                        translation = textPiece;\n                    else\n                        translation = this.escapeOutput(textPiece);\n                }\n            }\n            if (translation !== null) {\n                let reg = new RegExp(\"\\\\{\" + placeHolder + \"\\\\}\", \"g\");\n                text = text.replace(reg, translation);\n            }\n            else if (placeHolder.match(\"^[A-Za-z0-9_]+$\") !== null) {\n                this.log(\"No translation found for place holder: \" + placeHolder);\n                let reg = new RegExp(\"\\\\{\" + placeHolder + \"\\\\}\", \"g\");\n                text = text.replace(reg, \"MISSING: \" + this.escapeOutput(placeHolder));\n            }\n            else\n                start += placeHolder.length;\n        }\n        text = text.replace(/\\\\\\\\\\\\{/, \"{\");\n        return text;\n    }\n\n    public escapeOutput(text: string, convertNewlines: boolean = true) {\n        if (typeof text !== \"string\")\n            return text;\n        text = text.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#039;\");\n        if (typeof convertNewlines === \"undefined\" || convertNewlines === true)\n            text = text.replace(/\\r?\\n/g, \"<br>\");\n        return text;\n    }\n\n    public escapeRegex(str: string) {\n        return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n    }\n\n    public tr(key: string) {\n        //if (typeof language[key] === \"undefined\")\n        //return \"MISSING: \" + key;\n        //return language[key];\n        //return i18next.t(key) // will just print the key if it doesn't exist and debug is disabled\n        return key; // we don't have client-side translation support on this WP plugin yet. just return the key // TODO do we need this if we make our plugin use more ajax?\n    }\n\n    public log(args) {\n        if (//typeof pageData.debugLog !== \"boolean\" || pageData.debugLog === false || // TODO add in CashTipprConfig\n            typeof this.window.console !== \"object\" || typeof this.window.console.log !== \"function\")\n            return;\n        this.window.console.log(arguments);\n    }\n\n    public isAppleIOS() {\n        // https://stackoverflow.com/questions/9038625/detect-if-device-is-ios\n        return /iPad|iPhone|iPod/.test(this.window.navigator.userAgent) && !(this.window as any).MSStream;\n    }\n\n    public getAllCssSelectors(cached = true): string[] {\n        if (cached === true && this.cssSelectors.length !== 0)\n            return this.cssSelectors;\n\n        this.cssSelectors = [];\n        try {\n            const originRegex = new RegExp(\"^\" + this.escapeRegex(this.window.document.location.origin), \"i\");\n            for (let i = 0; i < this.window.document.styleSheets.length; i++)\n            {\n                const sheet: any = this.window.document.styleSheets[i];\n                if (sheet.href && originRegex.test(sheet.href) === false)\n                    continue; // can't access it\n                if (sheet.rules) {\n                    for (let u = 0; u < sheet.rules.length; u++)\n                    {\n                        if (sheet.rules[u].selectorText)\n                            this.cssSelectors.push(sheet.rules[u].selectorText);\n                    }\n                }\n                if (sheet.imports) {\n                    for (let x = 0; x < sheet.imports.length; x++)\n                    {\n                        for (let u = 0; u < sheet.imports[x].rules.length; u++)\n                        {\n                            if (sheet.imports[x].rules[u].selectorText)\n                                this.cssSelectors.push(sheet.imports[x].rules[u].selectorText);\n                        }\n                    }\n                }\n            }\n        }\n        catch (err) {\n            this.window.console.error(\"Error getting CSS selectors\", err);\n        }\n        return this.cssSelectors;\n    }\n\n    public isExistingCssSelector(selector: string): boolean {\n        const selectors = this.getAllCssSelectors();\n        for (let i = 0; i < selectors.length; i++)\n        {\n            if (selectors[i] === selector) // css props case insensitive, class names in HTML case sensitive\n                return true;\n        }\n        return false;\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    protected confirmCookies() {\n        /* // no data stored in session\n        this.getApi('/json/cookies', function(data) {\n            if (data.error)\n                //Hlp.showMsg(i18next.t('errorSending'), 'danger');\n                console.error(\"Error sending data\");\n            else {\n            }\n        })\n        */\n        this.$(this.config.confirmCookiesMsg).remove();\n        this.setCookie(this.config.consentCookieName, \"1\", this.config.cookieLifeDays);\n    }\n\n    public getApi(path: string, data?: any, callback?: (data: any, textStatus: string, jqXHR: JQueryXHR) => any, dataType?: string) {\n        if (typeof data === \"function\") {\n            callback = data;\n            data = null;\n        }\n        else if (data === undefined)\n            data = null;\n        let url = this.fixRelativeUrl(path);\n        return this.$.get(url, data, (data, textStatus, jqXHR) => {\n            callback(data, textStatus, jqXHR);\n        }, dataType);\n    }\n\n    public postApi(path: string, data?: any, callback?: (data: any, textStatus: string, jqXHR: JQueryXHR) => any, dataType?: string) {\n        let url = this.fixRelativeUrl(path);\n        return this.$.post(url, data, (data, textStatus, jqXHR) => {\n            callback(data, textStatus, jqXHR);\n        }, dataType);\n    }\n\n    protected fixRelativeUrl(url: string): string {\n        if (url.toLowerCase().indexOf(\"http\") === 0)\n            return url; // already a full url\n        let fullUrl = this.config.siteUrl;\n        if (url.length !== 0 && url[0] === \"/\" && fullUrl[fullUrl.length-1] === \"/\")\n            fullUrl = fullUrl.substr(0, fullUrl.length-1); // avoid duplicate //\n        fullUrl += url;\n        return fullUrl;\n    }\n}\n","import {AbstractModule} from \"../AbstractModule\";\nimport {VerifiedPay} from \"../VerifiedPay\";\n\nexport class AdminControls extends AbstractModule {\n    constructor(plugin: VerifiedPay) {\n        super(plugin);\n    }\n\n    public init() {\n        if (this.plugin.$(\"body\").attr(\"class\").indexOf(\"verifiedpay\") === -1)\n            return; // not our plugin settings page\n\n        this.plugin.getTooltips().initToolTips();\n        this.plugin.$(this.plugin.window.document).ready(($) => {\n\n        });\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n}\n","import {VerifiedPay} from \"../VerifiedPay\";\nimport {AbstractModule} from \"../AbstractModule\";\nimport {WebHelpers} from \"../WebHelpers\";\n\nexport class Tooltips extends AbstractModule {\n\n    constructor(plugin: VerifiedPay, webHelpers: WebHelpers) {\n        super(plugin, webHelpers);\n    }\n\n    /**\n     * Initializes status bar hover entries.\n     */\n    public initToolTips() {\n        const window = this.plugin.window;\n        const jQuery = this.plugin.$;\n        const that = this;\n        const tsfL10n = { // TODO localization\n            states: {\n                debug: false\n            }\n        }\n\n        let touchBuffer = 0,\n            inTouchBuffer = false;\n\n        const setTouchBuffer = function() {\n            inTouchBuffer = true;\n            clearTimeout( touchBuffer );\n            touchBuffer = window.setTimeout( function() {\n                inTouchBuffer = false;\n            }, 250 );\n        }\n\n        const setEvents = function( target, unset = false ) {\n\n            unset = unset || false;\n\n            let touchEvents = 'pointerdown.tsfTT touchstart.tsfTT click.tsfTT',\n                $target = jQuery( target );\n\n            if ( unset ) {\n                $target.off( 'mousemove mouseleave mouseout ct-tooltip-update' );\n                jQuery( document.body ).off( touchEvents );\n            } else {\n                $target.on( {\n                    'mousemove'  : mouseMove,\n                    'mouseleave' : mouseLeave,\n                    'mouseout'   : mouseLeave,\n                } );\n                jQuery( document.body ).off( touchEvents ).on( touchEvents, touchRemove );\n            }\n\n            $target.on( 'ct-tooltip-update', updateDesc );\n        }\n        const unsetEvents = function( target ) {\n            setEvents( target, true );\n        }\n        const updateDesc = function( event ) {\n            if ( event.target.classList.contains( 'ct-tooltip-item' ) ) {\n                let tooltipText = event.target.querySelector( '.ct-tooltip-text' );\n                if ( tooltipText instanceof Element )\n                    tooltipText.innerHTML = event.target.dataset.desc;\n            }\n        }\n        const mouseEnter = function( event ) {\n            let $hoverItem = jQuery( event.target ),\n                desc = event.target.dataset.desc;\n\n            if ( desc && 0 === $hoverItem.find( 'div' ).length ) {\n                //= Remove any titles attached.\n                event.target.title = \"\";\n\n                let $tooltip = jQuery(\n                    '<div class=\"ct-tooltip\"><span class=\"ct-tooltip-text-wrap\"><span class=\"ct-tooltip-text\">'\n                    + desc +\n                    '</span></span><div class=\"ct-tooltip-arrow\"></div></div>'\n                );\n                $hoverItem.append( $tooltip );\n\n                let $boundary = $hoverItem.closest( '.ct-tooltip-boundary' );\n                $boundary = $boundary.length && $boundary || jQuery( document.body );\n\n                //= 9 = arrow (8) + shadow (1)\n                let tooltipHeight = $hoverItem.outerHeight() + 9,\n                    tooltipTop = $tooltip.offset().top - tooltipHeight,\n                    boundaryTop = $boundary.offset().top - ( $boundary.prop( 'scrolltop' ) || 0 );\n\n                if ( boundaryTop > tooltipTop ) {\n                    $tooltip.addClass( 'ct-tooltip-down' );\n                    $tooltip.css( 'top', tooltipHeight + 'px' );\n                } else {\n                    $tooltip.css( 'bottom', tooltipHeight + 'px' );\n                }\n\n                let $hoverItemWrap = $hoverItem.closest( '.ct-tooltip-wrap' ),\n                    $textWrap = $tooltip.find( '.ct-tooltip-text-wrap' ),\n                    $innerText = $textWrap.find( '.ct-tooltip-text' ),\n                    hoverItemWrapWidth = $hoverItemWrap.width(),\n                    textWrapWidth = $textWrap.outerWidth( true ),\n                    textWidth = $innerText.outerWidth( true ),\n                    textLeft = $textWrap.offset().left,\n                    textRight = textLeft + textWidth,\n                    boundaryLeft = $boundary.offset().left - ( $boundary.prop( 'scrollLeft' ) || 0 ),\n                    boundaryRight = boundaryLeft + $boundary.outerWidth();\n\n                //= RTL and LTR are normalized to abide to left.\n                let direction = 'left';\n\n                if ( textLeft < boundaryLeft ) {\n                    //= Overflown over left boundary (likely window)\n                    //= Add indent relative to boundary. 24px width of arrow / 2 = 12 middle\n                    let horIndent = boundaryLeft - textLeft + 12,\n                        basis = parseInt( $textWrap.css( 'flex-basis' ), 10 );\n\n                    /**\n                     * If the overflow is greater than the tooltip flex basis,\n                     * the tooltip was grown. Shrink it back to basis and use that.\n                     */\n                    if ( horIndent < -basis )\n                        horIndent = -basis;\n\n                    $tooltip.css( direction, horIndent + 'px' );\n                    $tooltip.data( 'overflow', horIndent );\n                    $tooltip.data( 'overflowDir', direction );\n                } else if ( textRight > boundaryRight ) {\n                    //= Overflown over right boundary (likely window)\n                    //= Add indent relative to boundary. Add 12px for visual appeal.\n                    let horIndent = boundaryRight - textRight - hoverItemWrapWidth - 12,\n                        basis = parseInt( $textWrap.css( 'flex-basis' ), 10 );\n\n                    /**\n                     * If the overflow is greater than the tooltip flex basis,\n                     * the tooltip was grown. Shrink it back to basis and use that.\n                     */\n                    if ( horIndent < -basis )\n                        horIndent = -basis;\n\n                    $tooltip.css( direction, horIndent + 'px' );\n                    $tooltip.data( 'overflow', horIndent );\n                    $tooltip.data( 'overflowDir', direction );\n                } else if ( hoverItemWrapWidth < 42 ) {\n                    //= Small tooltip container. Add indent to make it visually appealing.\n                    let indent = -15;\n                    $tooltip.css( direction, indent + 'px' );\n                    $tooltip.data( 'overflow', indent );\n                    $tooltip.data( 'overflowDir', direction );\n                } else if ( hoverItemWrapWidth > textWrapWidth ) {\n                    //= Wrap is bigger than tooltip. Adjust accordingly.\n                    let pagex = event.originalEvent && event.originalEvent.pageX || event.pageX, // iOS touch support,\n                        hoverItemLeft = $hoverItemWrap.offset().left,\n                        center = pagex - hoverItemLeft,\n                        left = center - textWrapWidth / 2,\n                        right = left + textWrapWidth;\n\n                    if ( left < 0 ) {\n                        //= Don't overflow left.\n                        left = 0;\n                    } else if ( right > hoverItemWrapWidth ) {\n                        //= Don't overflow right.\n                        //* Use textWidth instead of textWrapWidth as it gets squashed in flex.\n                        left = hoverItemWrapWidth - textWidth;\n                    }\n\n                    $tooltip.css( direction, left + 'px' );\n                    $tooltip.data( 'adjust', left );\n                    $tooltip.data( 'adjustDir', direction );\n                }\n            }\n        }\n        const mouseMove = function( event ) {\n            let $target = jQuery( event.target ),\n                $tooltip = $target.find( '.ct-tooltip' ),\n                $arrow = $tooltip.find( '.ct-tooltip-arrow' ),\n                overflow = $tooltip.data( 'overflow' ),\n                overflowDir = $tooltip.data( 'overflowDir' );\n\n            overflow = parseInt( overflow, 10 );\n            overflow = isNaN( overflow ) ? 0 : - Math.round( overflow );\n\n            if ( overflow ) {\n                //= Static arrow based on static overflow.\n                $arrow.css( overflowDir, overflow + \"px\" );\n            } else {\n                let pagex = event.originalEvent && event.originalEvent.pageX || event.pageX, // iOS touch support\n                    arrowBoundary = 7,\n                    arrowWidth = 16,\n                    $hoverItemWrap = $target.closest( '.ct-tooltip-wrap' ),\n                    mousex = pagex - $hoverItemWrap.offset().left - arrowWidth / 2,\n                    originalMousex = mousex,\n                    $textWrap = $tooltip.find( '.ct-tooltip-text-wrap' ),\n                    textWrapWidth = $textWrap.outerWidth( true ),\n                    adjust = $tooltip.data( 'adjust' ),\n                    adjustDir = $tooltip.data( 'adjustDir' ),\n                    boundaryRight = textWrapWidth - arrowWidth - arrowBoundary;\n\n                //= mousex is skewed, adjust.\n                adjust = parseInt( adjust, 10 );\n                adjust = isNaN( adjust ) ? 0 : Math.round( adjust );\n                if ( adjust ) {\n                    adjust = 'left' === adjustDir ? -adjust : adjust;\n                    mousex = mousex + adjust;\n\n                    //= Use textWidth for right boundary if adjustment exceeds.\n                    if ( boundaryRight - adjust > $hoverItemWrap.outerWidth( true ) ) {\n                        let $innerText = $textWrap.find( '.ct-tooltip-text' ),\n                            textWidth = $innerText.outerWidth( true );\n                        boundaryRight = textWidth - arrowWidth - arrowBoundary;\n                    }\n                }\n\n                if ( mousex <= arrowBoundary ) {\n                    //* Overflown left.\n                    $arrow.css( 'left', arrowBoundary + \"px\" );\n                } else if ( mousex >= boundaryRight ) {\n                    //* Overflown right.\n                    $arrow.css( 'left', boundaryRight + \"px\" );\n                } else {\n                    //= Somewhere in the middle.\n                    $arrow.css( 'left', mousex + \"px\" );\n                }\n            }\n        }\n        const mouseLeave = function( event ) {\n\n            //* @see touchMove\n            if ( inTouchBuffer )\n                return;\n\n            jQuery( event.target ).find( '.ct-tooltip' ).remove();\n            unsetEvents( event.target );\n        }\n        /**\n         * ^^^\n         * These two methods conflict eachother in EdgeHTML.\n         * Thusly, touch buffer.\n         * vvv\n         */\n        const touchRemove = function( event ) {\n\n            //* @see mouseLeave\n            setTouchBuffer();\n\n            let itemSelector = '.ct-tooltip-item',\n                balloonSelector = '.ct-tooltip';\n\n            let $target = jQuery( event.target ),\n                $keepBalloon;\n\n            if ( $target.hasClass( 'ct-tooltip-item' ) ) {\n                $keepBalloon = $target.find( balloonSelector );\n            }\n            if ( ! $keepBalloon ) {\n                let $children = $target.children( itemSelector );\n                if ( $children.length ) {\n                    $keepBalloon = $children.find( balloonSelector );\n                }\n            }\n\n            if ( $keepBalloon && $keepBalloon.length ) {\n                //= Remove all but this.\n                jQuery( balloonSelector ).not( $keepBalloon ).remove();\n            } else {\n                //= Remove all.\n                jQuery( balloonSelector ).remove();\n            }\n        }\n\n        /**\n         * Loads tooltips within wrapper.\n         * @function\n         */\n        const loadToolTip = function( event ) {\n\n            if ( inTouchBuffer )\n                return;\n\n            let isTouch = false;\n\n            switch ( event.type ) {\n                case 'mouseenter' :\n                    //= Most likely, thus placed first.\n                    break;\n\n                case 'pointerdown' :\n                case 'touchstart' :\n                    isTouch = true;\n                    break;\n\n                default :\n                    break;\n            }\n\n            if ( event.target.classList.contains( 'ct-tooltip-item' ) ) {\n                //= Removes previous items and sets buffer.\n                isTouch && touchRemove( event );\n\n                mouseEnter( event );\n                //= Initiate placement directly for Windows Touch or when overflown.\n                mouseMove( event );\n\n                setEvents( event.target );\n            } else {\n                //= Delegate or bubble, and go back to this method with the correct item.\n                let item = event.target.querySelector( '.ct-tooltip-item:hover' ),\n                    _event = new jQuery.Event( event.type );\n\n                _event.pageX = event.originalEvent && event.originalEvent.pageX || event.pageX;\n\n                if ( item ) {\n                    if ( tsfL10n.states.debug ) console.log( 'Tooltip event warning: delegation' );\n                    jQuery( item ).trigger( _event );\n                } else {\n                    if ( tsfL10n.states.debug ) console.log( 'Tooltip event warning: bubbling' );\n                    jQuery( event.target ).closest( '.ct-tooltip-wrap' ).find( '.ct-tooltip-item:hover' ).trigger( _event );\n                }\n            }\n\n            //* Stop further propagation.\n            event.stopPropagation();\n        }\n\n        /**\n         * Initializes tooltips.\n         * @function\n         */\n        const initTooltips = function() {\n            let $wrap = jQuery( '.ct-tooltip-wrap' );\n\n            $wrap.off( 'mouseenter pointerdown touchstart' );\n            $wrap.on( 'mouseenter pointerdown touchstart', '.ct-tooltip-item', loadToolTip );\n        }\n        initTooltips();\n        jQuery( window ).on( 'ct-reset-tooltips', initTooltips );\n\n        (function() {\n            let e = jQuery( '#wpcontent' );\n            that.addTooltipBoundary( e );\n        })();\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n    /**\n     * Adds tooltip boundaries.\n     */\n    protected addTooltipBoundary( e ) {\n        jQuery( e ).addClass( 'ct-tooltip-boundary' );\n    }\n\n    /**\n     * Triggers tooltip reset.\n     */\n    protected _triggerTooltipReset() { // not used yet\n        jQuery( window ).trigger( 'ct-reset-tooltips' );\n    }\n\n    /**\n     * Triggers active tooltip update.\n     */\n    protected _triggerTooltipUpdate(item) { // not used yet\n        jQuery( item ).trigger( 'ct-tooltip-update' );\n    }\n}\n","\nexport class PaymentButtonID {\n    public readonly postID: number = 0;\n    public readonly buttonNr: number = 0;\n\n    constructor(combinedId: string) {\n        const idParts = combinedId.split(\"-\");\n        if (idParts.length !== 2)\n            throw new Error(\"PaymentButtonID must have exactly 2 parts: postID-buttonNr\");\n        this.postID = parseInt(idParts[0]);\n        this.buttonNr = parseInt(idParts[1]);\n    }\n\n    public getButtonIdStr(): string {\n        return `${this.postID}-${this.buttonNr}`;\n    }\n}\n","import {PaymentResponse} from \"./PaymentResponse\";\n\nexport class PaymentMap extends Map<string, PaymentResponse> { // (verified TX ID, pending payment)\n    constructor() {\n        super();\n    }\n\n    /**\n     * Merge certain pre-defined properties from the existing payment onto newData and return it.\n     * @param verifiedTxId\n     * @param newData\n     */\n    public mergeWithExisting(verifiedTxId: string, newData: PaymentResponse): PaymentResponse {\n        let payment = this.get(verifiedTxId);\n        if (payment !== undefined) { // should always be defined in our current payment flow\n            newData.is_restricted = payment.is_restricted;\n        }\n        this.set(verifiedTxId, newData);\n        return newData;\n    }\n}\n","\nexport type PaymentStatus = \"PENDING\" | \"PAID\" | \"CANCELLED\" | \"EXPIRED\" | \"HOLD\" | \"REFUNDED\";\n\nexport class PaymentResponse {\n    public readonly id: number;\n    public readonly tx_id: string; // the value the merchant supplied\n    public readonly token: string;\n    // TODO add more props\n    public readonly status: PaymentStatus;\n    public readonly paid_amount_crypto: number;\n    public readonly remaining_amount_crypto: number;\n    public readonly qr_url: string;\n    public readonly payment_link: string;\n    public readonly confirmations: number;\n\n    // added by TS client\n    public is_restricted: boolean = false;\n\n    constructor() {\n    }\n\n    public static fromJson(json: any): PaymentResponse {\n        return Object.assign(new PaymentResponse(), json); // copy properties\n    }\n\n    // ################################################################\n    // ###################### PRIVATE FUNCTIONS #######################\n\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import {VerifiedPay} from \"./src/VerifiedPay\";\n\nlet verifiedPayPlugin = new VerifiedPay(window as any, jQuery);\n(window as any).verifiedPayPlugin = verifiedPayPlugin;\n"],"sourceRoot":""}